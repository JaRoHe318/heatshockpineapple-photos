---
import BaseLayout from "../../layouts/BaseLayout.astro";
import photosData from "../../data/photos.json";

// Group photos by collection
const allPhotos = photosData.photos || [];
const uniqueCollections = [...new Set(allPhotos.map(p => p.collection))];

// Create a summary object for each collection (Name + 1 Cover Image)
const collections = uniqueCollections.map(name => {
  const photosInCollection = allPhotos.filter(p => p.collection === name);
  return {
    name: name,
    count: photosInCollection.length,
    cover: photosInCollection[0].src // Just grab the first photo as cover
  };
});
---

<BaseLayout title="Collections" description="Photo archive organized by series.">
  
  <header style="margin-bottom: 4rem;">
    <h1 style="font-family: var(--font-serif); font-size: 3rem;">Collections.</h1>
  </header>

  <div class="collections-grid">
    {collections.map((col) => (
      <a href={`/collections/${col.name}`} class="collection-card">
        <div class="cover-image-box">
          <img src={col.cover} alt={col.name} loading="lazy" />
          <div class="overlay">
            <span class="view-text">View Series</span>
          </div>
        </div>
        <div class="meta">
          <h2 class="name">{col.name}</h2>
          <span class="count">{col.count}</span>
        </div>
      </a>
    ))}
  </div>

</BaseLayout>

<style>
  .collections-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 40px;
  }

  @media (min-width: 700px) {
    .collections-grid { grid-template-columns: 1fr 1fr; }
  }

  .collection-card {
    text-decoration: none;
    group: pointer;
  }

  .cover-image-box {
    aspect-ratio: 3/2;
    overflow: hidden;
    border-radius: var(--radius);
    margin-bottom: 1rem;
    position: relative;
    background: var(--bg-surface);
  }

  .cover-image-box img {
    width: 100%; height: 100%; object-fit: cover;
    transition: transform 0.5s ease;
    filter: grayscale(20%);
  }

  .collection-card:hover img {
    transform: scale(1.05);
    filter: grayscale(0%);
  }

  .name {
    font-family: var(--font-serif);
    font-size: 1.5rem;
    color: var(--text-main);
    margin: 0;
    text-transform: capitalize;
  }

  .count {
    font-family: var(--font-mono);
    color: var(--text-muted);
    font-size: 0.8rem;
  }
</style>